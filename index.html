<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wizarding Meal Planner â€” Hogwarts Feast Game</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;background:#f8f4e6;color:#1a1a1a;font-family:'Crimson Text',serif;}
    header{padding:20px;text-align:center;background:linear-gradient(135deg,#7f0909,#d4af37);color:#fff;}
    h1{font-family:'Cinzel',serif;margin:0;font-weight:900}
    main{max-width:1100px;margin:20px auto;padding:0 16px 140px;display:grid;gap:16px;grid-template-columns:1fr .8fr}
    .card{background:#fff;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.15);padding:16px;margin-bottom:16px}
    .meal{border:2px solid #d4af37;border-radius:12px;padding:12px;background:#faf8ef}
    .food{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;border-radius:8px;margin-bottom:4px}
    .food:hover{background:#fdf5d4}
    .loglist{list-style:none;padding:0;margin:0}
    .logitem{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;border:1px dashed #ccc;border-radius:8px;margin-bottom:6px;background:#fffef9}
    .btn{padding:6px 10px;border:none;border-radius:8px;cursor:pointer;background:#0d6217;color:#fff;font-weight:700;margin-left:4px}
    .meter{height:16px;background:#eee;border-radius:999px;overflow:hidden;margin:6px 0}
    .meter>div{height:100%;width:0;background:linear-gradient(90deg,#0d6217,#eee117,#7f0909);transition:width .25s}
    .good{color:#0d6217;font-weight:700}
    .bad{color:#7f0909;font-weight:700}
    .toast{position:fixed;right:12px;bottom:80px;background:#111;color:#fff;padding:8px 12px;border-radius:8px;opacity:0;transition:.3s}
    .toast.show{opacity:1}
  </style>
</head>
<body>
  <header>
    <h1>Wizarding Meal Planner âš¡</h1>
    <div>IBSâ€‘Friendly â€¢ Dairyâ€‘Free â€¢ No Onion/Garlic â€¢ No Walnuts or Shellfish</div>
  </header>
  <main>
    <section>
      <div class="card">
        <h2>Meals</h2>
        <div id="meals"></div>
      </div>
      <div class="card">
        <h2>Today's Log</h2>
        <ul id="log" class="loglist"></ul>
      </div>
    </section>
    <aside>
      <div class="card">
        <h2>Daily Magic Meter</h2>
        <div class="meter"><div id="bar"></div></div>
        <p>Total: <b id="total">0</b> Calories â€¢ <span id="count">0</span> items</p>
        <p id="status"></p>
      </div>
      <div class="card">
        <h2>Hogwarts House Cup</h2>
        <p>Your House: <b id="house"></b></p>
        <p>House Points: <b id="points">0</b></p>
        <button id="claim" class="btn">Claim Daily Bonus</button>
        <button id="reset" class="btn">New Day Reset</button>
      </div>
    </aside>
  </main>
  <footer style="text-align:center;padding:10px;background:#fff8e6;border-top:3px solid #2e2a23;position:fixed;bottom:0;width:100%">
    Play the Hogwarts Feast Game: log meals, earn points, keep your house strong!
  </footer>  <template id="meal-template">
    <div class="meal">
      <h3></h3>
      <div class="foods"></div>
      <input class="name" placeholder="Custom item" />
      <input class="cal" placeholder="Calories" type="number" />
      <button class="btn estimate">Divine Calories</button>
      <button class="btn add">Conjure Item</button>
      <button class="btn apply">Feast on Selected</button>
    </div>
  </template>  <template id="food-template">
    <div class="food">
      <label><input type="checkbox"><span class="title"></span></label>
      <span class="cal"></span>
    </div>
  </template>
  <div id="toast" class="toast"></div>
  <script>
    const TARGET_MIN=1800,TARGET_MAX=2200;
    const KEY='hp_meal_planner_game';
    const STARTER={Breakfast:[{t:'Overnight oats (almond milk)',c:380},{t:'Eggs + spinach on GF toast',c:420}],Snack1:[{t:'Rice cakes + peanut butter',c:240}],Lunch:[{t:'Grilled chicken + quinoa',c:600}],Snack2:[{t:'Protein shake (DF)',c:280}],Dinner:[{t:'Roast chicken + potatoes',c:720}]};
    const MEALS=['Breakfast','Snack1','Lunch','Snack2','Dinner'];
    const HOUSES=['Gryffindor','Hufflepuff','Ravenclaw','Slytherin'];
    const HOUSE_COLORS={Gryffindor:'#7f0909',Hufflepuff:'#d4af37',Ravenclaw:'#0a1172',Slytherin:'#0d6217'};
    const HOUSE_EMOJIS={Gryffindor:'ðŸ¦',Hufflepuff:'ðŸ¦¡',Ravenclaw:'ðŸ¦…',Slytherin:'ðŸ'};
    const els={meals:document.getElementById('meals'),mealTpl:document.getElementById('meal-template'),foodTpl:document.getElementById('food-template'),log:document.getElementById('log'),total:document.getElementById('total'),count:document.getElementById('count'),bar:document.getElementById('bar'),status:document.getElementById('status'),toast:document.getElementById('toast'),house:document.getElementById('house'),points:document.getElementById('points'),claim:document.getElementById('claim'),reset:document.getElementById('reset')};
    const today = new Date().toISOString().slice(0,10);
    function allergenBlocked(name){return /(walnut|shrimp|prawn|lobster|crab|shellfish)/i.test(name);}

function estimateCalories(name){if(/banana/i.test(name))return 105;if(/apple/i.test(name))return 95;if(/rice/i.test(name))return 200;if(/chicken/i.test(name))return 200;return 120;}

function toast(msg){els.toast.textContent=msg;els.toast.classList.add('show');setTimeout(()=>els.toast.classList.remove('show'),1500);}

function getHouse(){return localStorage.getItem(KEY+'_house');}
function setHouse(h){localStorage.setItem(KEY+'_house',h);updateHeader();}
function updateHeader(){const h=getHouse();if(h){document.querySelector('header').style.background=`linear-gradient(135deg,${HOUSE_COLORS[h]},#333)`;document.querySelector('header h1').innerHTML=`Wizarding Meal Planner âš¡ ${HOUSE_EMOJIS[h]}`;els.house.textContent=h;}}

function getPoints(){return +localStorage.getItem(KEY+'_points') || 0;}
function addPoints(p){setPoints(getPoints()+p);}
function setPoints(p){localStorage.setItem(KEY+'_points',p);els.points.textContent=p;}

function getLastClaim(){return localStorage.getItem(KEY+'_last_claim');}
function setLastClaim(d){localStorage.setItem(KEY+'_last_claim',d);}
function canClaim(){return getLastClaim() !== today;}

function build(){els.meals.innerHTML='';if(!getHouse()){let h=prompt('Choose your Hogwarts House: Gryffindor, Hufflepuff, Ravenclaw, Slytherin').trim();while(!HOUSES.map(x=>x.toLowerCase()).includes(h.toLowerCase())){h=prompt('Invalid house! Choose again: Gryffindor, Hufflepuff, Ravenclaw, Slytherin').trim();}setHouse(HOUSES.find(x=>x.toLowerCase()===h.toLowerCase()));}updateHeader();setPoints(getPoints());MEALS.forEach(m=>{const node=els.mealTpl.content.cloneNode(true);node.querySelector('h3').textContent=m;const foods=node.querySelector('.foods');(STARTER[m]||[]).forEach(it=>foods.appendChild(makeFood(m,it.t,it.c)));node.querySelector('.add').onclick=()=>{const n=node.querySelector('.name').value.trim();const c=+node.querySelector('.cal').value;if(!n){toast('Enter item name, wizard!');return;}if(allergenBlocked(n)){toast('Blocked by allergen charm!');return;}const val=c||estimateCalories(n);foods.appendChild(makeFood(m,n,val,true));node.querySelector('.name').value='';node.querySelector('.cal').value='';};node.querySelector('.estimate').onclick=()=>{const n=node.querySelector('.name').value.trim();if(!n){toast('Enter item name, wizard!');return;}node.querySelector('.cal').value=estimateCalories(n);toast('Calories divined! ðŸª„');};node.querySelector('.apply').onclick=()=>{const cbs=[...foods.querySelectorAll('input:checked')];cbs.forEach(cb=>{addToLog({meal:m,title:cb.dataset.title,cal:+cb.dataset.cal});cb.checked=false;});};els.meals.appendChild(node);});renderLog();update();}

function makeFood(meal,title,cal){const n=els.foodTpl.content.cloneNode(true);const row=n.querySelector('.food');const cb=row.querySelector('input');cb.dataset.meal=meal;cb.dataset.title=title;cb.dataset.cal=cal;row.querySelector('.title').textContent=title;row.querySelector('.cal').textContent=cal+' cal';return n;}

function getLog(){return JSON.parse(localStorage.getItem(KEY+'_log')||'[]');}
function setLog(log){localStorage.setItem(KEY+'_log',JSON.stringify(log));renderLog();update();}
function addToLog(item){const log=getLog();log.push(item);setLog(log);addPoints(10);toast('Accio 10 points! ðŸ†');}
function removeFromLog(i){const log=getLog();log.splice(i,1);setLog(log);addPoints(-10);toast('Evanesco 10 points... ðŸ˜”');}

function renderLog(){const log=getLog();els.log.innerHTML='';log.forEach((x,i)=>{const li=document.createElement('li');li.className='logitem';li.innerHTML=`${x.title} <b>${x.cal} cal</b>`;const b=document.createElement('button');b.textContent='âœ–';b.className='btn';b.onclick=()=>removeFromLog(i);li.appendChild(b);els.log.appendChild(li);});}

function update(){const log=getLog();const total=log.reduce((a,b)=>a+b.cal,0);els.total.textContent=total;els.count.textContent=log.length;els.bar.style.width=Math.min(100,total/3000*100)+'%';if(total<TARGET_MIN)els.status.innerHTML='âš ï¸ Too low - Needs more magic!';else if(total>TARGET_MAX)els.status.innerHTML='âš ï¸ Too high - Overpowered!';else els.status.innerHTML='âœ… Brilliant feast!';els.status.className=(total>=TARGET_MIN&&total<=TARGET_MAX)?'good':'bad';els.claim.disabled=!(total>=TARGET_MIN&&total<=TARGET_MAX&&log.length>=5&&canClaim());}

els.claim.onclick=()=>{const log=getLog();const total=log.reduce((a,b)=>a+b.cal,0);if(total>=TARGET_MIN&&total<=TARGET_MAX&&log.length>=5&&canClaim()){addPoints(50);setLastClaim(today);toast('50 points to '+getHouse()+'! Expecto Patronum! âœ¨');update();}else{toast('Not ready yet, young wizard!');}};

els.reset.onclick=()=>{if(confirm('Reset log for a new day?')){setLog([]);toast('New day at Hogwarts!');}};

build();

  </script>
</body>
</html>
